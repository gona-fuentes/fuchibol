{% extends "usuarios/base.html" %}

{% block title %}Inicio{% endblock %}

{% block content %}

{% if messages %}
<div class="max-w-3xl mx-auto mb-8">
    {% for message in messages %}
        <div class="
            px-4 py-3 rounded relative shadow
            {% if message.tags == 'success' %}
                bg-green-100 border border-green-400 text-green-700
            {% elif message.tags == 'error' %}
                bg-red-100 border border-red-400 text-red-700
            {% else %}
                bg-blue-100 border border-blue-400 text-blue-700
            {% endif %}
        ">
            <span>{{ message }}</span>
            <button onclick="this.parentElement.remove()" class="absolute top-2 right-3 text-xl font-bold">&times;</button>
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- Sección 1: Carousel de imágenes -->
<div class="mb-12 relative">
    <div class="relative w-full overflow-hidden rounded shadow-lg">
        <div id="carousel" class="flex transition-transform duration-700">
            <img src="/fuchibol/media/canchas/estecancha.webp" class="w-full h-64 object-cover flex-shrink-0" alt="Cancha 1">
            <img src="/fuchibol/media/canchas/minicancha.webp" class="w-full h-64 object-cover flex-shrink-0" alt="Cancha 2">
            <img src="/fuchibol/media/canchas/nortecancha.webp" class="w-full h-64 object-cover flex-shrink-0" alt="Cancha 3">
        </div>
        <!-- Controles -->
        <button id="prev" class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75">&larr;</button>
        <button id="next" class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75">&rarr;</button>
        <!-- Indicadores -->
        <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
            <div class="w-3 h-3 bg-white bg-opacity-50 rounded-full cursor-pointer indicator active" data-slide="0"></div>
            <div class="w-3 h-3 bg-white bg-opacity-50 rounded-full cursor-pointer indicator" data-slide="1"></div>
            <div class="w-3 h-3 bg-white bg-opacity-50 rounded-full cursor-pointer indicator" data-slide="2"></div>
        </div>
    </div>
</div>

<!-- Sección 2: Historia del recinto -->
<div class="bg-white p-6 rounded shadow-md mb-12 grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
    <!-- Columna de texto -->
    <div>
        <h2 class="text-3xl font-bold mb-4 text-blue-700">Nuestra Historia</h2>
        <p class="text-gray-700 leading-relaxed">
            Todo comenzó hace más de 60 años, cuando don Ernesto, el niño más veloz del barrio,
            jugaba al fútbol descalzo en las canchas de tierra de su comunidad. Con el tiempo, su pasión por el deporte creció,
            y aunque la vida lo llevó por muchos caminos, nunca se alejó del fútbol.
            <br><br>
            Hoy, ya retirado, don Ernesto administra estas modernas canchas con la misma pasión con la que jugaba de niño.
            Cree firmemente que el deporte transforma vidas y que cada partido jugado aquí es una oportunidad de compartir,
            crecer y soñar.
        </p>
    </div>

    <!-- Columna de imagen -->
    <div class="flex justify-center">
        <img src="/fuchibol/media/canchas/nortecancha.webp" class="max-w-full h-auto rounded shadow-md" alt="Historia">
    </div>
</div>

<!-- Sección 3: Placeholder para futuras secciones -->
<div class="bg-gray-100 p-6 rounded shadow-md mb-12">
    <h2 class="text-2xl font-semibold text-gray-800 mb-4">[Sección futura]</h2>
    <p class="text-gray-600">Aquí puedes agregar una sección sobre precios, eventos especiales, o beneficios para socios.</p>
</div>

<!-- Sección 4: Otra sección futura -->
<div class="bg-gray-100 p-6 rounded shadow-md">
    <h2 class="text-2xl font-semibold text-gray-800 mb-4">[Otra sección futura]</h2>
    <p class="text-gray-600">Espacio disponible para testimonios de usuarios, horarios, reglamento, etc.</p>
</div>

<!-- Usuario autenticado (mensaje de bienvenida y reservas) -->
{% if user.is_authenticated %}
<div class="mt-12 bg-white p-6 rounded shadow-md">
    <h3 class="text-2xl font-semibold mb-4">Hola, {{ user.first_name }} {{ user.last_name }}!</h3>
    <p class="mb-4"><a href="{% url 'dashboard_usuario' %}" class="text-blue-600 hover:underline">Ir al Dashboard</a></p>

    <h4 class="text-lg font-semibold mb-2">Mis Reservas</h4>
    <ul class="list-disc list-inside text-gray-700">
        {% for reserva in reservas %}
            <li>{{ reserva.cancha.nombre }} - {{ reserva.fecha }} de {{ reserva.hora_inicio }} a {{ reserva.hora_fin }} ({{ reserva.estado }})</li>
        {% empty %}
            <li>No tienes reservas activas.</li>
        {% endfor %}
    </ul>
</div>
{% else %}
<div class="mt-12 bg-white p-6 rounded shadow-md text-center">
    <p class="text-lg mb-4">¿Quieres jugar? ¡Reserva tu cancha ahora!</p>
    <a href="{% url 'login' %}" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Iniciar sesión</a>
    <a href="{% url 'registrar' %}" class="ml-4 text-blue-600 hover:underline">Registrarse</a>
</div>
{% endif %}

<script>
const carousel = document.getElementById('carousel');
const prevBtn = document.getElementById('prev');
const nextBtn = document.getElementById('next');
const indicators = document.querySelectorAll('.indicator');
let currentSlide = 0;
const totalSlides = 3;

function updateCarousel() {
    carousel.style.transform = `translateX(-${currentSlide * 100}%)`;
    indicators.forEach((ind, index) => {
        ind.classList.toggle('active', index === currentSlide);
    });
}

nextBtn.addEventListener('click', () => {
    currentSlide = (currentSlide + 1) % totalSlides;
    updateCarousel();
});

prevBtn.addEventListener('click', () => {
    currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
    updateCarousel();
});

indicators.forEach((ind, index) => {
    ind.addEventListener('click', () => {
        currentSlide = index;
        updateCarousel();
    });
});

// Auto-slide every 5 seconds
setInterval(() => {
    currentSlide = (currentSlide + 1) % totalSlides;
    updateCarousel();
}, 5000);
</script>

{% endblock %}
